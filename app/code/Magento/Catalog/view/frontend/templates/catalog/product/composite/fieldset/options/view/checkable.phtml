<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

/**
 * @var \Magento\Catalog\Block\Product\View\Options\View\Checkable $block
 */
$option = $block->getOption();

if ($option) : ?>
<?php
$configValue = $block->getProduct()->getPreconfiguredValues()->getData('options/' . $option->getId());
$optionType = $option->getType();
$arraySign = $optionType === 'checkbox' ? '[]' : '';
$count = 1;
?>

<div class="options-list nested" id="options-' <?= /* @noEscape */ $option->getId() ?>'-list">

    <?php if ($optionType === 'radio') : ?>
    <div class="field choice field field-option">
        <input type="radio"
               id="options_<?= /* @noEscape */ $option->getId() ?>"
               class="radio control-radio product-custom-option"
               name="options[<?= /* @noEscape */ $option->getId() ?>]"
               data-selector="options[<?= /* @noEscape */ $option->getId() ?>]"
               onclick="<?= $block->getSkipJsReloadPrice() ? '' : 'opConfig.reloadPrice()' ?>"
               value=""
               checked="checked"
        />
        <label class="label field-label" for="options_<?= /* @noEscape */ $option->getId() ?>">
                <span>
                    <?= /* @noEscape */ __('None') ?>
                </span>
        </label>
    <?php endif; ?>

        <?php foreach ($option->getValues() as $value) : ?>
            <?php
            $checked = '';
            $count++;

            if ($arraySign) {
                $checked = is_array($configValue) && in_array($value->getOptionTypeId(), $configValue) ? 'checked' : '';
            } else {
                $checked = $configValue == $value->getOptionTypeId() ? 'checked' : '';
            }

            $priceStr = $block->formatPrice(
                [
                    'is_percent' => $value->getPriceType() === 'percent',
                    'pricing_value' => $value->getPrice($value->getPriceType() === 'percent')
                ]
            );

            $dataSelector = 'options[' . $option->getId() . ']';
            if ($arraySign) {
                $dataSelector .= '[' . $value->getOptionTypeId() . ']';
            }
            ?>

            <div class="field choice field field-option'<?= /* @noEscape */ $option->getIsRequire() ?>'">
                <input type="<?= /* @noEscape */ $optionType ?>" class="<?= /* @noEscape */
                       $optionType === 'radio' ?
                           'radio control-radio' :
                           'checkbox control-checkbox' ?>
                        <?= /* @noEscape */ $option->getIsRequire() ?>
                       product-custom-option
                        <?= $block->getSkipJsReloadPrice() ? '' : 'opConfig.reloadPrice()' ?>"
                       name="options[<?= $option->getId() ?>]<?= /* @noEscape */ $arraySign ?>"
                       id="options_<?= /* @noEscape */ $option->getId() . '_' . $count ?>"
                       value="<?= /* @noEscape */ $value->getOptionTypeId() ?>"
                    <?= /* @noEscape */ $checked ?>
                       data-selector="<?= /* @noEscape */ $dataSelector ?>"
                       price="<?= /* @noEscape */ $block->getCurrencyByStore($value) ?>"
                />
                <label class="label field-label"
                       for="options_<?= /* @noEscape */ $option->getId() . '_' . $count ?>">
                <span>
                    <?= $block->escapeHtml($value->getTitle()) ?>
                </span>
                    <?= /* @noEscape */ $priceStr ?>
                </label>
            </div>
        <?php endforeach; ?>
    </div>
<?php endif; ?>

