<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

use Magento\Catalog\Api\Data\ProductCustomOptionInterface;

/**
 * @var \Magento\Catalog\Block\Product\View\Options\Select\Checkable $block
 */
$option = $block->getOption();

if ($option) : ?>
<?php
$configValue = $block->getPreconfiguredValue($option);
$optionType = $option->getType();
$arraySign = $optionType === ProductCustomOptionInterface::OPTION_TYPE_CHECKBOX ? '[]' : '';
$count = 1;
?>

<div class="options-list nested" id="options-<?= /* @noEscape */ $option->getId() ?>-list">

    <?php if ($optionType === ProductCustomOptionInterface::OPTION_TYPE_RADIO) : ?>
    <div class="field choice admin__field admin__field-option">
        <input type="radio"
               id="options_<?= /* @noEscape */ $option->getId() ?>"
               class="radio admin__control-radio product-custom-option"
               name="options[<?= /* @noEscape */ $option->getId() ?>]"
               data-selector="options[<?= /* @noEscape */ $option->getId() ?>]"
               onclick="<?= $block->getSkipJsReloadPrice() ? '' : 'opConfig.reloadPrice()' ?>"
               value=""
               checked="checked"
        />
        <label class="label admin__field-label" for="options_<?= /* @noEscape */ $option->getId() ?>">
                <span>
                    <?= /* @noEscape */ __('None') ?>
                </span>
        </label>
    </div>
    <?php endif; ?>

        <?php foreach ($option->getValues() as $value) : ?>
            <?php
            $checked = '';
            $count++;

            if ($arraySign) {
                $checked = is_array($configValue) && in_array($value->getOptionTypeId(), $configValue) ? 'checked' : '';
            } else {
                $checked = $configValue == $value->getOptionTypeId() ? 'checked' : '';
            }

            $dataSelector = 'options[' . $option->getId() . ']';
            if ($arraySign) {
                $dataSelector .= '[' . $value->getOptionTypeId() . ']';
            }
            ?>

            <div class="field choice admin__field admin__field-option'<?= /* @noEscape */ $option->getIsRequire() ?>'">
                <input type="<?= /* @noEscape */ $optionType ?>"
                       class="<?= /* @noEscape */
                       /** @noinspection DisconnectedForeachInstructionInspection */
                        $optionType === ProductCustomOptionInterface::OPTION_TYPE_RADIO ?
                           'radio admin__control-radio' :
                           'checkbox admin__control-checkbox' ?> <?= /* @noEscape */ $option->getIsRequire() ?>
                       product-custom-option
                        <?= $block->getSkipJsReloadPrice() ? '' : 'opConfig.reloadPrice()' ?>"
                       name="options[<?= $option->getId() ?>]<?= /* @noEscape */ $arraySign ?>"
                       id="options_<?= /* @noEscape */ $option->getId() . '_' . $count ?>"
                       value="<?= /* @noEscape */ $value->getOptionTypeId() ?>"
                    <?= /* @noEscape */ $checked ?>
                       data-selector="<?= /* @noEscape */ $dataSelector ?>"
                       price="<?= /* @noEscape */ $block->getCurrencyByStore($value) ?>"
                />
                <label class="label admin__field-label"
                       for="options_<?= /* @noEscape */ $option->getId() . '_' . $count ?>">
                <span>
                    <?= $block->escapeHtml($value->getTitle()) ?>
                </span>
                    <?= /* @noEscape */ $block->formatPrice($value) ?>
                </label>
            </div>
        <?php endforeach; ?>
</div>
<?php endif; ?>

