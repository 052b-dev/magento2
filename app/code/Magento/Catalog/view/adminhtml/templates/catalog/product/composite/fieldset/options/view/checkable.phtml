<?php
/**
 * @var \Magento\Catalog\Block\Product\View\Options\View\Checkable $this
 */
$option = $this->getOption();

if ($option) : ?>
<?php
$configValue = $this->getProduct()->getPreconfiguredValues()->getData('options/' . $option->getId());
$optionType = $option->getType();
$arraySign = $optionType === 'checkbox' ? '[]' : '';
$count = 1;
?>

<div class="options-list nested" id="options-' . <?= $option->getId() ?> . '-list">

    <?php if ($optionType === 'radio') : ?>
        <div class="field choice admin__field admin__field-option">
            <input type="radio"
                   id="options_'<?= $option->getId() ?>'"
                   class="radio admin__control-radio product-custom-option"
                   name="options['<?= $option->getId() ?>']"
                   data-selector="options['<?= $option->getId() ?>']"
                   onclick="<?= $this->getSkipJsReloadPrice() ? '' : 'opConfig.reloadPrice()' ?>"
                   value=""
                   checked="checked"
            />
            <label class="label admin__field-label" for="options_<?= $option->getId() ?>">
                <span>
                    <?= __('None') ?>

                </span>

            </label>
    <?php endif; ?>

        <?php foreach ($option->getValues() as $value) : ?>
            <?php
            $checked = '';

            if ($arraySign) {
                $checked = is_array($configValue) && in_array($value->getOptionTypeId(), $configValue) ? 'checked' : '';
            } else {
                $checked = $configValue == $value->getOptionTypeId() ? 'checked' : '';
            }

            $priceStr = $this->formatPrice(
                [
                    'is_percent' => $value->getPriceType() == 'percent',
                    'pricing_value' => $value->getPrice($value->getPriceType() == 'percent')
                ]
            );

            $dataSelector = 'options[' . $option->getId() . ']';
            if ($arraySign) {
                $dataSelector .= '[' . $value->getOptionTypeId() . ']';
            }
            ?>

            <div class="field choice admin__field admin__field-option'<?= $option->getIsRequire() ?>'">
                <input type="<?= $optionType ?>"
                       class="<?= /** @noinspection DisconnectedForeachInstructionInspection */
                        $optionType === 'radio' ?
                           'radio admin__control-radio' :
                           'checkbox admin__control-checkbox' ?> <?= $option->getIsRequire() ?>
                       product-custom-option
                        <?= $this->getSkipJsReloadPrice() ? '' : 'opConfig.reloadPrice()' ?>"
                       name="options['<?= $option->getId() ?>']<?= $arraySign ?>"
                       id="options_<?= $option->getId() . '_' . $count ?>."
                       value="<?= $value->getOptionTypeId() ?>"
                    <?= $checked ?>
                       data-selector="<?= $dataSelector ?>"
                       price="<?= $this->getCurrencyByStore($value) ?>"
                />
                <label class="label admin__field-label" for="options_<?= $option->getId() . '_' . $count ?>">
                <span>
                    <?= $this->escapeHtml($value->getTitle()) ?>
                </span>
                    <?= $priceStr ?>
                </label>
            </div>
        <?php endforeach; ?>
        </div>
<?php endif; ?>

